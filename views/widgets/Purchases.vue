<template>
    <div class="container">

        <!-- Start .header-section -->
        <div class="content-header-section separator">
            <div class="row between-xs">
                <div class="col">
                    <h2 class="content-header__title">{{ this.$func.__('Purchases Transactions', 'erp') }}</h2>
                    <combo-box
                        :options="pages"
                        :hasUrl="true"
                        :placeholder="this.$func.__('New Transaction', 'erp')" />
                </div>
            </div>
        </div>
        <!-- End .header-section -->

        <purchases-stats />
        <transactions-filter  :types="filterTypes" :people="{title: this.$func.__('Vendor', 'erp'), items: vendors}"/>
        <purchases-list />

    </div>
</template>

<script>

export default {

    components: {
        PurchasesStats: window.$func.fetchComponent('components/transactions/purchases/PurchasesStats.vue'),
        PurchasesList: window.$func.fetchComponent('components/transactions/purchases/PurchasesList.vue'),
        TransactionsFilter: window.$func.fetchComponent('components/transactions/TransactionsFilter.vue'),
        ComboBox: window.$func.fetchComponent('components/select/ComboBox.vue')
    },

    data() {
        return {
            pages: [
                { namedRoute: 'PurchaseCreate', name: this.$func.__('Create Purchase', 'erp') },
                { namedRoute: 'PayPurchaseCreate', name: this.$func.__('Pay Purchase', 'erp') },
                { namedRoute: 'PurchaseOrderCreate', name:  this.$func.__('Create Purchase Order', 'erp') }
            ],
            filterTypes:[
                { id: 'purchase', name: this.$func.__('Purchase', 'erp') },
                { id: 'pay_purchase', name: this.$func.__('Payment', 'erp') },
                { id: 'receive_pay_purchase', name: this.$func.__('Receive', 'erp') },
            ],
            pro_activated: false,
        };
    },

    computed: mapState({
        vendors: state => state.purchase.vendors
    }),

    created() {
        setTimeout(()=>{
            this.pro_activated =  this.$store.state.erp_pro_activated ?  this.$store.state.erp_pro_activated : false
            if(this.pro_activated ){
                this.pages.push({ namedRoute: 'PurchaseReturnList', name:  this.$func.__('Purchase Return', 'erp') })
             }
        }, 200);

        if(!this.vendors.length){
            this.$store.dispatch('purchase/fetchVendors');
        }
    }

    };
</script>
